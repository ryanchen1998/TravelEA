@import play.mvc.Http.Request
@import helper._
@(user: String, destList: Seq[models.Destination], tripList: List[models.frontend.Trip])(implicit request: Request, messages: play.i18n.Messages)



@scripts = {
    @*<script src="@routes.Assets.at("javascripts/destinations.js")" type="text/javascript"></script>*@
    <script src="@routes.Assets.at("javascripts/trips.js")" type="text/javascript"></script>
}

@layouts.imageHeader("Create Trip", user, "images/home-bg.jpg", scripts){

    <main role="main" id="createTripContainer" class="container pb-3 mb-5">

        <!-- Destination cards -->
        <!doctype html>
        <html lang="en">
            <head>
                <meta charset="utf-8">
                <meta name="viewport" content="width=device-width, initial-scale=1">
                <title>jQuery UI Sortable - Default functionality</title>
                <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
                <link rel="stylesheet" href="/resources/demos/style.css">
                <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
                <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
                <script>
                        $( function() {
                            $( "#list" ).disableSelection().sortable({
                                scroll: true,
                                axis: 'x',
                                revert: true
                            });
                        } );
                </script>
            </head>
            <body>
                <label id="tripError"></label>
                    <!-- Destination card deck -->
                <div id="parent" class="parent">
                    <div id="list" class="list">
                        <!-- Destinations inserted here -->
                    </div>
                </div>
            </body>
        </html>


        <!-- Buttons to add/create destination and trip -->
        <div style="float: left;">
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#modalContactForm">Create Destination</button>
            <button type="submit" class="btn btn-primary" onclick='getAllDestinations("@controllers.backend.routes.DestinationController.getAllDestinations()")'
            data-toggle="modal" data-target="#modalAddForm">Add Destination</button>
        </div>

        <div style="float: right;">
            <button class="btn btn-primary" onclick='createTrip("@controllers.backend.routes.TripController.insertTrip()",
                                                           "@controllers.routes.TripsController.index()")'>Done</button>
        </div>


        <!-- Create destination form -->
        <div class="container">
            <div class="modal fade" id="modalContactForm" tabindex="-1" role="dialog" aria-labelledby="modalLabel"
            aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title w-100 font-weight-bold">Create New Destination</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <form id="addDestinationForm">
                            <div class="modal-body mx-3">
                                <div>Name
                                    <i class="fas prefix grey-text"></i>
                                    <input type="text" name="name" class="form-control validate" required>
                                    <label id="nameError"></label>
                                </div>

                                <div>Type
                                    <i class="fas prefix grey-text"></i>
                                    <input type="text" name="_type" class="form-control validate" required>
                                    <label id=_typeError"></label>
                                </div>

                                <div>District
                                    <i class="fas prefix grey-text"></i>
                                    <input type="text" name="district" class="form-control validate" required>
                                    <label id="districtError"></label>
                                </div>

                                <div>Latitude
                                    <i class="fas prefix grey-text"></i>
                                    <input type="text" name="latitude" class="form-control validate" pattern="[0-9]+([\.,][0-9]+)?" step="any" required>
                                    <label id="latitudeError"></label>
                                </div>

                                <div>Longitude
                                    <i class="fas prefix grey-text"></i>
                                    <input type="text" name="longitude" class="form-control validate" pattern="[0-9]+([\.,][0-9]+)?" step="any" required>
                                    <label id="longitudeError"></label>
                                </div>

                                <div>Country
                                    <i class="fas prefix grey-text"></i>
                                    <select id="countryDropDown" name="countryId" class="form-control validate">
                                        // Countries inserted from script here
                                    </select>
                                    <label id="countryError"></label>
                                </div>
                            </div>
                        </form>
                        <div class="modal-footer d-flex justify-content-center">
                            <button class="btn btn-popup waves-effect waves-light" data-toggle="modal" data-target="#modalContactForm">
                                Cancel<i class="fas fa-paper-plane-o ml-1"></i>
                            </button>
                            <button class="btn btn-popup" onclick=
                            'newDestination("@controllers.backend.routes.DestinationController.addNewDestination()")'>
                                Create
                            </button>
                            <label id="otherError"></label>
                        </div>
                    </div>
                </div>
            </div>


        <!-- Edit arrival depart times form -->
        @helper.form(routes.createTripController.index()) {
            @helper.CSRF.formField
            <div class="modal fade" id="modalEditForm" tabindex="-1" role="dialog" aria-labelledby="modalLabel"
            aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title w-100 font-weight-bold">Edit date and times</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                            <div class="container">
                                <form>
                                    <div class="form-group">
                                        <label for="Departure time">Departure time</label>
                                        <input type="date" class="form-control" id="Departure date" >
                                        <input type="time" class="form-control" id="Departure time" >
                                    </div>

                                    <div class="form-group">
                                        <label for="Arrival time">Arrival time</label>
                                        <input type="date" class="form-control" id="Arrival date" >
                                        <input type="time" class="form-control" id="Arrival time" >
                                    </div>
                                </form>
                            </div>
                        <div class="modal-footer d-flex justify-content-center">
                            <button class="btn btn-popup">Done<i class="fas fa-paper-plane-o ml-1"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        }

        <!-- Form to add destination to trip -->
        @helper.form(routes.createTripController.index()) {
            @helper.CSRF.formField
            <div class="modal fade" id="modalAddForm" tabindex="-1" role="dialog" aria-labelledby="modalLabel"
            aria-hidden="true">
                <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                        <div class="modal-header text-center">
                            <h4 class="modal-title w-100 font-weight-bold">Add destination to trip</h4>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="container">
                            <form>
                                <div class="destTable"><br>
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th scope="col">Name</th>
                                                <th scope="col">Type</th>
                                                <th scope="col">District</th>
                                                <th scope="col">Latitude</th>
                                                <th scope="col">Longitude</th>
                                                <th scope="col">Country</th>
                                                <th scope="col"></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                        @*TODO: Fix this section now that destinations controller has been removed*@
                                        @for(d <- destList) {
                                            <tr id="@d.id">
                                                <td>@d.name</td>
                                                <td>@d._type</td>
                                                <td>@d.district</td>
                                                <td>@d.latitude</td>
                                                <td>@d.longitude</td>
                                                <td id="country">@d.countryId</td>
                                                <td><button class="btn btn-popup" type="button" onclick='addDestinationToTrip(["@d.id", "@d.name", "@d._type", "@d.district", "@d.latitude", "@d.longitude", "@d.countryId"])'>Add</button></td>
                                            </tr>
                                        }
                                        </tbody>
                                    </table>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer d-flex justify-content-center">
                            <button class="btn btn-popup waves-effect waves-light" type="button" data-toggle="modal" data-target="#modalAddForm">Done</button>
                        </div>
                    </div>
                </div>
            </div>
        }

     </div>
    </main>

}

<script type="text/javascript">
        fillCountryInfo("@controllers.backend.routes.DestinationController.getAllCountries()");
</script>